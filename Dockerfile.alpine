# Debug image using Alpine (includes shell and basic tools)
FROM alpine:latest

# Install ca-certificates for HTTPS
RUN apk --no-cache add ca-certificates

# GoReleaser v2 organizes binaries in $TARGETPLATFORM/ (e.g., linux/amd64/)
ARG TARGETPLATFORM
COPY ${TARGETPLATFORM}/aws-smtp-relay /bin/aws-smtp-relay

# Use non-root user
USER 65534

ENTRYPOINT ["/bin/aws-smtp-relay"]
